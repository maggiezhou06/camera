(function(e){function t(t){for(var s,o,r=t[0],l=t[1],c=t[2],d=0,h=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&h.push(n[o][0]),n[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);u&&u(t);while(h.length)h.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],s=!0,r=1;r<a.length;r++){var l=a[r];0!==n[l]&&(s=!1)}s&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},n={app:0},i=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var s=a("85ec"),n=a.n(s);n.a},"18b1":function(e,t,a){},"2fad":function(e,t,a){"use strict";var s=a("5aee"),n=a.n(s);n.a},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("a026"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("div",[a("b-navbar",{staticClass:"nav-bg",attrs:{toggleable:"lg",type:"dark"}},[a("b-navbar-brand",{attrs:{href:"#"}},[e._v("Vue Camera")]),a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",[a("b-nav-item",{attrs:{to:"/"}},[e._v("Camera")]),a("b-nav-item",{attrs:{to:"/gallery",disabled:0===e.cloudname.length||0===e.preset.length}},[e._v("Gallery")])],1),a("b-navbar-nav",{staticClass:"ml-auto"},[a("b-nav-item",[a("div",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-prevent-closing",modifiers:{"modal-prevent-closing":!0}}],staticClass:"settings"},[a("i",{staticClass:"fas fa-cog"})]),a("b-modal",{ref:"modal",attrs:{id:"modal-prevent-closing",title:"Cloudinary Upload Info"},on:{show:e.resetModal,hidden:e.resetModal,ok:e.handleOk}},[a("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},[a("b-form-group",{attrs:{state:e.cloudnameState,label:"Cloudname","label-for":"cloud-name-input","invalid-feedback":"Cloudname is required"}},[a("b-form-input",{attrs:{id:"cloud-name-input",state:e.cloudnameState,required:""},model:{value:e.cloudname,callback:function(t){e.cloudname=t},expression:"cloudname"}})],1),a("b-form-group",{attrs:{state:e.presetState,label:"Preset","label-for":"preset-input","invalid-feedback":"Preset is required"}},[a("b-form-input",{attrs:{id:"preset-input",state:e.presetState,required:""},model:{value:e.preset,callback:function(t){e.preset=t},expression:"preset"}})],1),a("b-form-group",[a("b-form-checkbox",{attrs:{id:"clearsettings",name:"clearsettings",value:"true","unchecked-value":"false"},model:{value:e.clearsettings,callback:function(t){e.clearsettings=t},expression:"clearsettings"}},[e._v("Clear Settings")])],1)],1)])],1),a("b-nav-item",[a("div",{directives:[{name:"b-modal",rawName:"v-b-modal.info-modal",modifiers:{"info-modal":!0}}],staticClass:"settings"},[a("i",{staticClass:"fas fa-info-circle"})]),a("b-modal",{ref:"modal",attrs:{id:"info-modal",title:"Instructions"}},[a("p",[e._v(" You need to "),a("a",{attrs:{href:"https://cloudinary.com/users/register/free",target:"_blank"}},[e._v("register for a Cloudinary account")]),e._v(" to get a cloud name. ")]),a("p",[e._v(" Once you have an account go to settings | upload to create an unsigned preset. ")]),a("p",[e._v(" For information on creating an unsigned upload preset, look "),a("a",{attrs:{href:"https://cloudinary.com/documentation/upload_images?query=settings%20upload%20preset&c_query=Upload%20presets#upload_presets",target:"_blank"}},[e._v("here.")]),e._v(" Be sure to choose the unsigned option when creating the upload preset. ")]),a("p",[e._v(" Click on the settings icon (gear) to enter your cloud name and preset. This will allow you to upload your images to cloudinary and then view them using the Gallery navigation link. ")]),a("div",{attrs:{id:"nav"}},[e.authenticated?a("router-link",{attrs:{to:"/login",replace:""},nativeOn:{click:function(t){return e.logout()}}},[e._v("Logout")]):e._e()],1),a("router-view",{on:{authenticated:e.setAuthenticated}})],1)],1)],1)],1)],1)],1),a("b-container",[a("b-row",{staticClass:"routes"},[a("b-col",{attrs:{sm:"12"}},[a("router-view")],1)],1)],1)],1)},i=[],o={name:"app",created:function(){this.$ls.get("cloudname")&&(this.cloudname=this.$ls.get("cloudname")),this.$ls.get("preset")&&(this.preset=this.$ls.get("preset"))},data(){return{cloudnameState:null,presetState:null,clearsettings:"false",expire:36e5,authenticated:!1,mockAccount:{username:"maggiezhou06",password:"test123"}}},computed:{cloudname:{get(){return this.$store.state.settings.cloudname},set(e){this.$store.commit("updateCloudname",e)}},preset:{get(){return this.$store.state.settings.preset},set(e){this.$store.commit("updatePreset",e)}}},mounted(){this.authenticated||this.$router.replace({name:"Login"})},methods:{setAuthenticated(e){this.authenticated=e},logout(){this.authenticated=!1},checkFormValidity(){return!!(this.cloudname&&this.cloudname.length>0&&this.preset&&this.preset.length>0)||(this.$bvToast.toast("Enter cloudname and preset to complete form save.",{title:"Settings",autoHideDelay:5e3,appendToast:!1}),!1)},resetModal(){this.cloudnameState=null,this.presetState=null},handleOk(e){e.preventDefault(),this.handleSubmit()},handleSubmit(){if("true"===this.clearsettings)return this.cloudname="",this.preset="",this.clearsettings="false",this.$ls.clear(),void this.$nextTick(()=>{this.$refs.modal.hide()});this.checkFormValidity()&&(this.$ls.set("cloudname",this.cloudname,this.expire),this.$ls.set("preset",this.preset,this.expire),this.$nextTick(()=>{this.$refs.modal.hide()}))}}},r=o,l=(a("034f"),a("2877")),c=Object(l["a"])(r,n,i,!1,null,null,null),u=c.exports,d=a("8c4f"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("camera")],1)},p=[],m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"camera"},[a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("div",[a("video",{directives:[{name:"show",rawName:"v-show",value:e.cameraState,expression:"cameraState"}],attrs:{playsinline:"",autoplay:""}}),a("canvas",{directives:[{name:"show",rawName:"v-show",value:!e.cameraState,expression:"!cameraState"}]})]),a("div",{staticClass:"actions"},[a("b-button-group",[e.cameraState?e._e():a("b-button",{attrs:{disabled:e.isStartEnabled},on:{click:e.start}},[e._v("Camera")]),e.cameraState?a("b-button",{attrs:{disabled:e.isStartEnabled},on:{click:e.stop}},[e._v("Stop")]):e._e(),e.cameraState?a("b-button",{attrs:{disabled:e.isStartEnabled},on:{click:e.snapshot}},[e._v("Snapshot")]):e._e(),e.isPhoto?a("b-button",{attrs:{disabled:!e.isPhoto},on:{click:e.download}},[e._v("Download")]):e._e(),e.isPhoto?a("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}]},[e.isPhoto?a("b-button",{attrs:{disabled:!e.isPhoto||0===e.settings.cloudname.length||0===e.settings.preset.length},on:{click:e.upload}},[e._v("Upload")]):e._e()],1):e._e(),a("input",{attrs:{id:"name",placeholder:"Enter name: "}})],1)],1)])],1),a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("form",{},[a("b-form-select",{attrs:{options:e.options,size:"sm"},on:{change:function(t){return e.deviceChange()}},model:{value:e.selectedDevice,callback:function(t){e.selectedDevice=t},expression:"selectedDevice"}})],1),e._v("` ")])],1),a("b-row",[a("b-col",{attrs:{sm:"12"}})],1)],1)},v=[],g=a("bc3a"),f=a.n(g),b=a("2f62");async function y(e,t,a){try{let s=new FormData,n=`https://api.cloudinary.com/v1_1/${e}/image/upload`;s.append("upload_preset",t),s.append("tags","browser_upload"),s.append("file",a);let i=await f()({method:"post",url:n,data:s});return await i.data}catch(s){throw s}}var w={name:"Camera",data(){return{video:null,canvas:null,fileData:null,isStartEnabled:!0,isPhoto:!1,stream:null,currentStream:null,devices:[],options:[],constraints:{},selectedDevice:null,cameraState:!0}},computed:Object(b["b"])(["settings"]),methods:{upload:function(){0!==this.settings.cloudname.length&&0!==this.settings.preset.length?y(this.settings.cloudname,this.settings.preset,this.fileData).then(e=>{this.$bvToast.toast("Upload to Cloudinary successful",{title:"Cloudinary Upload",autoHideDelay:5e3,appendToast:!1}),this.cameraState=!0,console.log("upload to cloudinary:",e)}).catch(e=>{this.$bvToast.toast("Upload to Cloudinary unsuccessful. Check settings.",{title:"Cloudinary Upload",autoHideDelay:5e3,appendToast:!1}),console.log("upload to cloudinary error:",e)}):this.$bvToast.toast("Upload to Cloudinary unsuccessful: use settings to provide cloudname and preset",{title:"Cloudinary Upload",autoHideDelay:5e3,appendToast:!1})},snapshot:function(){this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height),this.fileData=this.canvas.toDataURL("image/jpeg"),this.isPhoto=!0,this.cameraState=!1;let e=document.querySelectorAll(".hidden_links");for(let t of e)document.querySelector("body").remove(t)},stop:function(){this.video.pause(),this.currentStream&&(this.currentStream.getTracks().forEach(e=>{e.stop()}),this.video.srcObject=null),this.video.removeAttribute("src"),this.video.load(),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.isPhoto=!1,this.cameraState=!1},start:function(){this.stop(),this.selectedDevice=this.options[0].value,this.getMedia().then(e=>{this.isStartEnabled=!1,this.cameraState=!0,console.log("start camera:",e)})},download:function(){if(this.fileData){this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height);let e=document.createElement("a");e.classList.add("hidden-link"),e.href=this.fileData,e.textContent="",e.target="_blank",e.download="photo.jpeg",document.querySelector("body").append(e),e.click()}},getMedia:async function(){try{return this.stream=await navigator.mediaDevices.getUserMedia(this.constraints),window.stream=this.stream,this.currentStream=window.stream,this.video.srcObject=window.stream,!0}catch(e){throw e}},deviceChange:function(){this.stop(),this.setConstraints(),this.getMedia().then(e=>{this.isStartEnabled=!1,this.cameraState=!0,console.log("device change:",e)})},setConstraints:function(){const e={};null===this.selectedDevice?e.facingMode="environment":e.deviceId={exact:this.selectedDevice},this.constraints={video:e,audio:!1}},getDevices:async function(){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return!1;try{let e=await navigator.mediaDevices.enumerateDevices();for(let t of e)if("videoinput"===t.kind){let e={};e.text=t.label,e.value=t.deviceId,this.options.push(e),this.devices.push(t)}return!0}catch(e){throw e}}},mounted(){this.canvas=document.querySelector("canvas"),this.video=document.querySelector("video"),this.getDevices().then(e=>{this.selectedDevice=this.options[0].value,this.setConstraints(),console.log("get devices:",e)}).then(()=>{this.getMedia().then(e=>{this.isStartEnabled=!1,console.log("get media",e)})})}},_=w,S=(a("d458"),Object(l["a"])(_,m,v,!1,null,"4b85fba4",null)),C=S.exports,k={name:"Home",data(){return{}},components:{camera:C}},$=k,x=Object(l["a"])($,h,p,!1,null,null,null),D=x.exports,P=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},O=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"gallery"}},[a("h2",[e._v("Gallery")]),a("section",{attrs:{id:"images"}})])}],j={name:"gallery",mounted(){this.$ls.get("cloudname")&&(this.cloudname=this.$ls.get("cloudname")),this.$ls.get("preset")&&(this.preset=this.$ls.get("preset")),this.myGallery=cloudinary.galleryWidget({container:"#images",cloudName:this.cloudname,mediaAssets:[{tag:"browser_upload"}]}),this.myGallery.render()},beforeDestroy:function(){this.myGallery.destroy},data(){return{myGallery:null}},computed:{cloudname:{get(){return this.$store.state.settings.cloudname},set(e){this.$store.commit("updateCloudname",e)}}}},E=j,T=(a("2fad"),Object(l["a"])(E,P,O,!1,null,"65ce499e",null)),M=T.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"login"}},[a("h2",[e._v("Login")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.input.username,expression:"input.username"}],attrs:{type:"text",name:"username",placeholder:"Username"},domProps:{value:e.input.username},on:{input:function(t){t.target.composing||e.$set(e.input,"username",t.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.input.password,expression:"input.password"}],attrs:{type:"password",name:"password",placeholder:"Password"},domProps:{value:e.input.password},on:{input:function(t){t.target.composing||e.$set(e.input,"password",t.target.value)}}}),a("button",{attrs:{type:"button"},on:{click:function(t){return e.login()}}},[e._v("Login")])])},q=[],L={name:"Login",data(){return{input:{username:"",password:""}}},methods:{login(){if(""!=this.input.username&&""!=this.input.password){alert("login step 1");const e=a("bc3a");e.get("http://54.175.248.168:8081/listUsers",{params:{Username:this.input.username,Password:this.input.password}}).then((function(){alert("login step 2"),this.$emit("authenticated",!0),this.$router.replace({name:"Camera"})})).catch((function(){alert("The username/password is incorrect")}))}else alert("Must enter a username and password")}}},N=L,G=(a("c782"),Object(l["a"])(N,U,q,!1,null,"77dac08f",null)),H=G.exports;s["default"].use(d["a"]);var A=new d["a"]({routes:[{path:"/",name:"home",component:D},{path:"/gallery",name:"gallery",component:M},{path:"/",redirect:{name:"Login"}},{path:"/Login",name:"Login",component:H},{path:"/Camera",name:"Camera",component:C}]});s["default"].use(b["a"]);const I=new b["a"].Store({state:{settings:{cloudname:"",preset:""}},mutations:{updateCloudname(e,t){e.settings.cloudname=t},updatePreset(e,t){e.settings.preset=t}}});var F=I,V=a("5f5b"),W=(a("f9e3"),a("2dd8"),a("c16e")),z=a.n(W);s["default"].use(V["a"]);let J={namespace:"camera__",name:"ls",storage:"local"};s["default"].use(z.a,J),s["default"].config.productionTip=!1,new s["default"]({router:A,store:F,render:e=>e(u)}).$mount("#app")},"5aee":function(e,t,a){},"85ec":function(e,t,a){},8709:function(e,t,a){},c782:function(e,t,a){"use strict";var s=a("8709"),n=a.n(s);n.a},d458:function(e,t,a){"use strict";var s=a("18b1"),n=a.n(s);n.a}});
//# sourceMappingURL=app.728fb578.js.map